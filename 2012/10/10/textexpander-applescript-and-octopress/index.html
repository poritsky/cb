
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Some AppleScript and TextExpander Goodies for Octopress - the candler blog</title>
  <meta name="author" content="Jonathan Poritsky">

  
  <meta name="description" content="I’ve grown quite fond of TextExpander over the past year, but never more so than when I’m blogging with Octopress. Slowly I’ve built up an arsenal of &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.candlerblog.com/2012/10/10/textexpander-applescript-and-octopress/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feedpress.me/candlerblog" rel="alternate" title="the candler blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<script type="text/javascript" src="//use.typekit.net/agp6cdf.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script type="text/javascript" src="/javascripts/styleTweets.js"></script>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-4886664-4']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  <script type="text/javascript">
  (function(){
    var fusion = document.createElement('script');
    fusion.src = window.location.protocol + '//adn.fusionads.net/api/1.0/ad.js?zoneid=252&rand=' + Math.floor(Math.random()*9999999);
    fusion.async = true;
    (document.head || document.getElementsByTagName('head')[0]).appendChild(fusion);
  })();</script>
  <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">the candler blog</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feedpress.me/candlerblog" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://next.duckduckgo.com/" method="get">
  <fieldset role="search">
    <input type="hidden" name="sites" value="candlerblog.com" />
    <input type="hidden" name="kj" value="#D45949"/>
    <input type="hidden" name="kf" value="-1"/>
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/contact">Contact</a></li>
  <li><a href="/projects">Projects</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="beforearticle">
<article class="hentry" role="article">
  
  <header>
    
  
      <h1 class="entry-title">Some AppleScript and TextExpander Goodies for Octopress</h1>
    
    
    <p class="meta">
      








  


<time datetime="2012-10-10T12:08:00+00:00" pubdate data-updated="true">October 10<span>th</span>, 2012</time>&emsp;

<span class="categories">
  
    <a class='category' href='/blog/categories/blogging/'>Blogging</a>, <a class='category' href='/blog/categories/octopress/'>Octopress</a>, <a class='category' href='/blog/categories/technology/'>Technology</a>
  
</span>


      
    </p>
  </header>


<div class="entry-content"><p>I’ve grown quite fond of TextExpander over the past year, but never more so than when I’m blogging with Octopress. Slowly I’ve built up an arsenal of snippets to make writing posts easier. Allow me to explain the thinking behind a few.</p>

<p>If you’re impatient just head to the bottom of the article for download info. And if you’re uninterested in this blogging from blogging, I’ll see you at the next post.</p>

<h3 id="rake-what-rake">Rake? What Rake?</h3>

<p>The fastest way to start up a new post is to <code>cd</code> into your Octopress install in a Terminal and type <code>rake new_post["Post Title"]</code>. This generates a brand new <code>.markdown</code> file in your <code>/source/_posts/</code> directory with filled in YAML front matter. So with my sample rake just a few sentences back, we would get a new file called <code>2012-10-10-post-title.markdown</code> pre-populated with the following:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class=""><span class="line">---
</span><span class="line">layout: post
</span><span class="line">title: "Post Title"
</span><span class="line">date: 2012-10-10 12:54
</span><span class="line">comments: true
</span><span class="line">categories: 
</span><span class="line">---</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>I never really enjoyed having to go to the command line just to start a new post. Worse, I usually don’t know what I want to call a post, nor what the URL should be right away, but I like getting that YAML filled in nonetheless. Lucky for me, all I need to do is create a file in the <code>/source/_posts/</code> folder with the proper file naming convention and YAML filled in. Enter TextExpander.</p>

<h3 id="editing-text-via-ftp">Editing Text via FTP</h3>

<p>Quick sidebar here. Back in August, Gabe over at Macdrifter gave an excellent overview of <a href="http://www.macdrifter.com/2012/08/working-remotely-with-sublime-text-and-bbedit-ftp-access.html">how he edits text via FTP</a>. He provides detailed instructions to set up both Sublime Text 2 and BBEdit to work with text on an FTP server. I’ve tried both but prefer the latter, with one difference: I use <a href="http://www.textwrangler.com/products/textwrangler/">TextWrangler</a>.</p>

<p>TextWrangler is probably the best bargain on the Mac inasmuch as it’s free. It’s essentially a stripped down version of BBEdit, but the features it’s missing hardly hamper it, if you ask me. For example, it still connects via FTP or SFTP to the server and directory of your choosing.</p>

<p>Following Gabe’s instructions, I set up a path right to my <code>source/_posts</code> directory. Now, I can open from (⌘^O) or save to (⌘^S) my server right from the keyboard. Now all I need to do is properly format that YAML and URL.</p>

<h3 id="a-simple-and-a-not-so-simple-yaml">A Simple and a Not-So-Simple YAML</h3>

<p>Let me get this URL thingamajig out of the way. Here’s what the TextExpander snippet looks like:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">%Y-%m-%d-%|.markdown</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>That gives you a file with today’s date and your cursor correctly placed so you can start typing the filename. Remember, all lowercase and no spaces. I use <code>uurl</code> to call this one when I’m saving a file.</p>

<p>Now, as to the YAML front matter. I’ve got a basic one that I call with <code>yyaml</code>. You can dig into the snippet at the bottom to really see what’s going on, but basically it gives you a blank YAML with the time and date pre-populated and the cursor positioned to give the post a title.</p>

<p>Most of my posts on the candler blog, however, are link posts. For those I have to add a line to my YAML for <code>external-url</code>. For that I now turn to an AppleScript snippet that fills in almost everything I need to post right away.</p>

<p>The groundwork for this was <a href="http://canadian-fury.com/2012/09/06/applescript-and-friends-octopress-textexpander-and-ruby/">laid by Doug Stephen</a> with his snippet to strip out some oddities from a URL and create a new link blog type post from it. In his method he actually modified his rake task to create link posts when he entered a title with a specific format, but that’s all command line-y, so it’s no good for me. The brilliance in his work was actually stripping out the long, useless additions URLs, especially from RSS feeds, tend to have. All of that has been retained in my tweak here.</p>

<p>So here’s the workflow I was looking for (and have actually achieved):</p>

<ol>
  <li>Find a cool story I want to link in Safari.</li>
  <li>Select the text I plan to quote.</li>
  <li>Fire up a blank TextWrangler document, type TextExpander snippet.</li>
  <li>Editorialize as needed.</li>
</ol>

<p>The following AppleScript, when saved as a snippet, does all of that, though it’s not the snippet I prefer.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
</pre></td><td class="code"><pre><code class=""><span class="line">on replaceCommasInStringWithHTMLEntity(theTitle)
</span><span class="line">	set rubyCommand to quote &amp; "puts " &amp; "'" &amp; theTitle &amp; "'" &amp; ".gsub( /,/, '&#44;' )" &amp; quote
</span><span class="line">	set strippedTitle to do shell script "ruby -e " &amp; rubyCommand
</span><span class="line">	return strippedTitle
</span><span class="line">end replaceCommasInStringWithHTMLEntity
</span><span class="line">
</span><span class="line">on stripUTMFromURL(urlToStrip)
</span><span class="line">	set rubyCommand to quote &amp; "puts " &amp; "'" &amp; urlToStrip &amp; "'" &amp; ".gsub( /\\?utm.*$/, '' )" &amp; quote
</span><span class="line">	set strippedURL to do shell script "ruby -e " &amp; rubyCommand
</span><span class="line">	return strippedURL
</span><span class="line">end stripUTMFromURL
</span><span class="line">
</span><span class="line">tell application "Safari"
</span><span class="line">	set pageTitle to name of document 1
</span><span class="line">	set currentURL to URL of current tab of window 1
</span><span class="line">	set selectedText to (do JavaScript "window.getSelection().toString()" in document 1)
</span><span class="line">end tell
</span><span class="line">
</span><span class="line">set pageTitle to replaceCommasInStringWithHTMLEntity(pageTitle)
</span><span class="line">set currentURL to stripUTMFromURL(currentURL)
</span><span class="line">set theDate to current date
</span><span class="line">
</span><span class="line">return "---" &amp; "
</span><span class="line">" &amp; "layout: post" &amp; "
</span><span class="line">" &amp; "title: " &amp; "\"" &amp; pageTitle &amp; "\"" &amp; "
</span><span class="line">" &amp; "date: " &amp; (do shell script "date +%Y") &amp; "-" &amp; (do shell script "date +%m") &amp; "-" &amp; (do shell script "date +%d") &amp; " " &amp; (do shell script "date +%H") &amp; ":" &amp; (do shell script "date  +%M") &amp; "
</span><span class="line">" &amp; "comments: true" &amp; "
</span><span class="line">" &amp; "categories: " &amp; "
</span><span class="line">" &amp; "- " &amp; "
</span><span class="line">" &amp; "external-url: " &amp; currentURL &amp; "
</span><span class="line">" &amp; "---" &amp; "
</span><span class="line">" &amp; "
</span><span class="line">" &amp; "&gt; " &amp; selectedText</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>It works excellently, as advertised. And thanks to Doug Stephen’s work cluttered URLs come across clean. My one gripe was that, since the whole snippet is an AppleScript, the cursor cannot be placed within the YAML text. But I found a workaround.</p>

<h3 id="snippets-all-the-way-down">Snippets All the Way Down</h3>

<p>Until just yesterday, I had no idea one could embed a TextExpander snippet inside a TextExpander snippet. Let me say that again: <strong>you can embed a TextExpander snippet inside a TextExpander</strong>. And as many times as you like. It’s as easy as adding putting in a snippet placeholder.</p>

<p>With that in mind, I created separate snippets from the AppleScript above to get the page title, the URL and the selected text; three separate AppleScript snippets. Then I created my snippet for link post YAML front matter incorporating the snippets for title, URL and quoted text appropriately.</p>

<p>The main advantage here is that users of other static blogging engines can incorporate the AppleScript to fit their YAML template. Additionally, it’s much easier to change the text output from within TextExpander than to modify the ray AppleScript.</p>

<h3 id="download">Download</h3>

<p>I’m using <a href="https://github.com/ttscoff/Brett-s-TextExpander-Snippets">Brett Terpstra’s nifty TextExpander tool</a> to help you make some sense of the snippets I’ve listed above. You can see them all laid out <a href="http://poritsky.com/te-snippets/">here</a>. Please note that I haven’t implemented Brett’s “prefix” system here, so the expansion abbreviations won’t change if you add commas as a prefix. I recommend downloading the snippets and adjusting their abbreviations as needed. Here’s <a href="http://poritsky.com/te-snippets/te-download.php?group=Octopress%20Snippets&amp;prefix=%2C%2C">the download link</a>.</p>

<p>And that’s about it. Happy blogging.</p>

</div>

  <footer>
    <!--<p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jonathan Poritsky</span></span>

      








  


<time datetime="2012-10-10T12:08:00+00:00" pubdate data-updated="true">October 10<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/blogging/'>Blogging</a>, <a class='category' href='/blog/categories/octopress/'>Octopress</a>, <a class='category' href='/blog/categories/technology/'>Technology</a>
  
</span>


    </p>-->
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2012/10/10/owc-on-thunderbolt/" title="Previous Post: A Closer Look At Thunderbolt External Storage">&laquo; A Closer Look At Thunderbolt External Storage</a>
      
      
        <a class="basic-alignment right" href="/2012/10/10/connect/" title="Next Post: What is mobile photography, and why are we still asking that question?">What is mobile photography, and why are we still asking that question? &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
<p class=about-aside>The candler blog is a film theory and criticism (and other stuff) Web site by Jonathan Poritsky. You&#8217;re on it right now. Check out the <a href="http://feedpress.me/candlerblog">RSS</a> and <a href="https://twitter.com/thecandlerblog">Twitter</a> feeds to stay up to date. Now on App.net too: <a href='https://alpha.app.net/thecandlerblog' rel='me'><i class="icon-adn"></i></a></p>
</section><section>
  
<p><form action="https://next.duckduckgo.com/" method="get">
  <fieldset role="search">
    <input type="hidden" name="sites" value="candlerblog.com" />
    <input type="hidden" name="kj" value="#D45949"/>
    <input type="hidden" name="kf" value="-1"/>
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form></p>
  
</section>
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Jonathan Poritsky -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'candlerblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.candlerblog.com/2012/10/10/textexpander-applescript-and-octopress/';
        var disqus_url = 'http://www.candlerblog.com/2012/10/10/textexpander-applescript-and-octopress/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>










</body>
</html>
